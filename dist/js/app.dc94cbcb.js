(function(e){function t(t){for(var i,c,a=t[0],s=t[1],l=t[2],h=0,d=[];h<a.length;h++)c=a[h],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&d.push(o[c][0]),o[c]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);u&&u(t);while(d.length)d.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,a=1;a<n.length;a++){var s=n[a];0!==o[s]&&(i=!1)}i&&(r.splice(t--,1),e=c(c.s=n[0]))}return e}var i={},o={app:0},r=[];function c(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=i,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)c.d(n,i,function(t){return e[t]}.bind(null,i));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/bbtan/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],s=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=s;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0214":function(e,t,n){e.exports=n.p+"img/fullScreen.f9a7f51c.png"},"27de":function(e,t,n){"use strict";n("aa82")},2826:function(e,t,n){"use strict";n("e8a9")},3214:function(e,t,n){"use strict";n("d55f")},"49be":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("7a23");function o(e,t,n,o,r,c){var a=Object(i["k"])("Game");return Object(i["g"])(),Object(i["b"])(a)}var r=Object(i["o"])("data-v-3da9e021");Object(i["i"])("data-v-3da9e021");var c={class:"home_wrapper"};Object(i["h"])();var a=r((function(e,t,o,r,a,s){var l=Object(i["k"])("UserHamburgerMenu"),u=Object(i["k"])("ActionsMenu"),h=Object(i["k"])("GameScene");return Object(i["g"])(),Object(i["b"])("div",c,[Object(i["e"])(l,{show:a.showHamburgerMenu,src:n("c749"),onToggleShow:t[1]||(t[1]=function(e){return a.showHamburgerMenu=e})},null,8,["show","src"]),Object(i["e"])(u,{"highest-score":a.game.highestScore},null,8,["highest-score"]),Object(i["e"])(h)])})),s=n("bc3a"),l=n.n(s),u=n("5502"),h=Object(u["a"])({state:{logged:-1,username:""},mutations:{SET_LOGGED:function(e,t){e.logged=t},SET_USERNAME:function(e,t){e.username=t}},actions:{setUsername:function(e,t){var n=e.commit;n("SET_USERNAME",t)},setLogged:function(e,t){var n=e.commit;n("SET_LOGGED",t)}}}),d=n("cf05"),b=n.n(d),g=Object(i["o"])("data-v-46b0159a");Object(i["i"])("data-v-46b0159a");var f={class:"user-hamburger-menu__menu"},m={key:0,class:"user-menu"},p=Object(i["d"])("Username: "),v={key:1,class:"user-menu"},w=Object(i["e"])("p",null,"You are currently not logged in",-1);Object(i["h"])();var O=g((function(e,t,n,o,r,c){return Object(i["g"])(),Object(i["b"])("div",{class:["user-hamburger-menu__main-panel",{hidden:!n.show}],onClick:t[6]||(t[6]=Object(i["n"])((function(){}),["stop"]))},[Object(i["e"])("div",{class:["user-hamburger-menu__icon",{rotated:n.show}],onClick:t[1]||(t[1]=function(){return c.toggleMenu&&c.toggleMenu.apply(c,arguments)})},[Object(i["e"])("img",{src:n.src,alt:"menu"},null,8,["src"])],2),Object(i["e"])("div",f,[Object(i["e"])("img",{class:"home-button",src:b.a,onClick:t[2]||(t[2]=function(){return c.redirectToHome&&c.redirectToHome.apply(c,arguments)}),alt:"Home"}),c.username?(Object(i["g"])(),Object(i["b"])("div",m,[Object(i["e"])("div",null,[Object(i["e"])("p",null,[p,Object(i["e"])("strong",null,Object(i["l"])(decodeURIComponent(c.username)),1)]),Object(i["e"])("button",{onClick:t[3]||(t[3]=function(){return c.logout&&c.logout.apply(c,arguments)})},"Logout")]),c.logged?Object(i["c"])("",!0):(Object(i["g"])(),Object(i["b"])("button",{key:0,class:"proceed-with-google",onClick:t[4]||(t[4]=function(){return c.redirectToGoogle&&c.redirectToGoogle.apply(c,arguments)})},"Activate sync with google"))])):(Object(i["g"])(),Object(i["b"])("div",v,[w,Object(i["e"])("button",{class:"proceed-with-google",onClick:t[5]||(t[5]=function(){return c.redirectToGoogle&&c.redirectToGoogle.apply(c,arguments)})},"Sign in now with google")]))])],2)})),k=n("d4ef"),j=n.n(k),y=function(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"arcade";return{type:j.a.AUTO,physics:{default:r,arcade:{debug:!1},matter:{debug:!1}},canvasStyle:"border: 2px solid white;",parent:t,width:n,height:i,scene:e,scaleMode:o}},_={width:800,height:1e3,blockWidth:100,blockHeight:100,bulletSpeed:1e3},S="https://papero.me",x={baseUrl:"https://papero.me",getLoginInfoUrl:S+"/user/get_info",createLocalAccountUrl:S+"/auth/local",logoutUrl:S+"/auth/logout",game:S+"/server/bbtan/game"},G=[6534552,13532536,15375984,10783390,13033960,6586743,1835877,1354157,5022457,10806335,13801698,6363600,13792125,12624956,15880462,6626278,7962734,6412894,13446912,9652399,109651,12952827,10053173,11605363,4961395,3096468,3111833,14325373,3442975,11589755,13256529,8278184,12899911,14741176,1171137,2660370,5663904,16767969,3084665,9657197,9529736,5324184,11447610,10382705,4938716,840557,2426466,13327338,2263318,11288091,14635338,5477271,8915319,16160705,12228302,6790301,13026348,6106194,4764699,14798651,6022384,5752024,10801530,140728,12476555,9875468,560047,15816895,14763450,15634915,381809,5514976,4732112,8397364,6769128,618992,9417747,11711728,12830877,13216065,4313432,16458147,5353177,6009645,526331,2184078,9033012,13854279,8369169,9144,3902506,9988947,16057378,9977722,15344803,7943468,5378640,13082322,14081426,14892626,11714135,16385772,1816217,7024223,6586895,115313,2184078,9033012,13854279,8369169,9144,3902506,9988947,16057378,9977722,15344803,7943468,5378640,13082322,14081426,14892626,11714135,16385772,1816217,7024223,6586895,115313,10270282,10054728,10140087,450642,14918785,964129,16532878,11721493,11149933,7941848,7571242,5377338,13565112,10859481,8199557,12909911,15838742,9429546,15691324,2375403,121880,14521341,4162675,15195086,4333433,8011155,6512493,9695959,10181674,1423854,1005975,4231560,9510432,1265870,1107377,16774359,13313410,13500606,3331542,94770,6325618,13081538,63612,7829290,6919610,16542551,15759381,9427075,396839,9889169,2217262,13631555,11825506,2015783,5181295,1908056,9728002,12443730,14715990,2686205,766107,3557482,13643305,1763035,4081228,11029135,9510526,4134617,1004127,11303946,11845766,13227824,3198025,4024145,16468995,6557633,6471742,13846842,8956427,4222457,6380272,310855,2765876,4871231,7978144,11057364,61396,8049206,7495896,1960615,455738,8535129,14932300,14425094,16071466,11821624,3014646,11021193,1736721,4418207,1736810,5042333,12683426,6810443,11733203,16547393,11481345,1044581,7451124,10680485,14826960,13846637,63481,4671635,3992629,1861067,6102284,2981162,16725024,6086023,10639780,14986308,1830374,8886436,14121231,11715151,14578626,14092956,154471,8972728,12759266,8841615,11440354,1736811,4418206,966911,16257715,11632585,9268271,13838202,2924974,9864683,9082566,14394086,7797787,6328228,2160314,514038,14477178,7859402];function E(){for(var e=[],t=0;t<4;t++){var n=parseInt(8*Math.random());e[n]?t--:e[n]={x:n,y:1,left:1,start:1}}var i=[];return e.forEach((function(e){e&&i.push(e)})),{level:1,spritePosition:3*_.blockWidth,blocks:i}}var B={name:"UserHamburgerMenu",props:{src:{required:!0},show:Boolean},computed:{logged:function(){return this.$store.state.logged},username:function(){return this.$store.state.username}},mounted:function(){var e=this;window.addEventListener("click",(function(){e.$emit("toggle-show",!1)}))},methods:{toggleMenu:function(){this.$emit("toggle-show",!this.show)},redirectToHome:function(){window.location.href="/"},redirectToGoogle:function(){var e=window.location;window.location.href="/auth/google?from_location="+e},logout:function(){l.a.get(x.logoutUrl)}}};n("2826");B.render=O,B.__scopeId="data-v-46b0159a";var F=B,H=n("f773"),L=n.n(H),M=Object(i["o"])("data-v-f1c06190");Object(i["i"])("data-v-f1c06190");var T={class:"menu_wrapper",id:"actions_menu"},I=Object(i["e"])("div",{class:"home_title"},[Object(i["e"])("img",{src:L.a,alt:"title"})],-1),P={class:"menu_container"},U={class:"level_info_wrapper"},q={class:"level_info_label"},R={class:"restart_wrapper"},A=Object(i["e"])("div",{class:"quit_wrapper"},[Object(i["e"])("button",{class:"quit_button",id:"quit_button"},"Save & Quit")],-1);Object(i["h"])();var W=M((function(e,t,n,o,r,c){return Object(i["g"])(),Object(i["b"])("div",T,[I,Object(i["e"])("div",P,[Object(i["e"])("div",U,[Object(i["e"])("a",q,"Highest score: "+Object(i["l"])(n.highestScore),1)]),Object(i["e"])("div",R,[Object(i["e"])("button",{class:"restart_button",onClick:t[1]||(t[1]=function(){return c.restartGame&&c.restartGame.apply(c,arguments)})},"Restart")]),A])])})),C=(n("a9e3"),n("14b7"));window.mitt=window.mitt||new C["a"];var K={name:"ActionsMenu",props:{highestScore:Number},methods:{restartGame:function(){window.mitt.emit("restart"),document.getElementById("actions_menu").classList.remove("visible"),document.getElementById("quit_button").innerHTML="Save & Quit"}}};n("e135");K.render=W,K.__scopeId="data-v-f1c06190";var N=K,Y=n("0214"),D=n.n(Y),X=Object(i["o"])("data-v-270a14a0");Object(i["i"])("data-v-270a14a0");var $={class:"scene_wrapper",id:"parent"},Q=Object(i["e"])("img",{src:D.a,alt:"full screen"},null,-1);Object(i["h"])();var J=X((function(e,t,n,o,r,c){return Object(i["g"])(),Object(i["b"])("div",$,[Object(i["e"])("div",{id:"fullScreenButton",class:"full-screen",onClick:t[1]||(t[1]=function(){return c.fullScreen&&c.fullScreen.apply(c,arguments)})},[Q])])})),V=n("d4ec"),z=n("bee2"),Z=n("257e"),ee=n("262e"),te=n("2caf"),ne=n("ade3");n("159b");window.mitt=window.mitt||new C["a"];var ie={font:"30px Arial",fill:"#000000",wordWrap:!0,wordWrapWidth:_.blockWidth,align:"left"},oe=function(e){Object(ee["a"])(n,e);var t=Object(te["a"])(n);function n(e){var i;return Object(V["a"])(this,n),i=t.call(this),Object(ne["a"])(Object(Z["a"])(i),"nextFire",0),Object(ne["a"])(Object(Z["a"])(i),"fireRate",100),Object(ne["a"])(Object(Z["a"])(i),"fireX",0),Object(ne["a"])(Object(Z["a"])(i),"fireY",0),Object(ne["a"])(Object(Z["a"])(i),"gameOver",!1),i.raw_blocks=e.blocks,i.level=e.level,i.spritePosition=e.spritePosition,i.shooting=!1,i.bulletsKilled=0,i.bulletsShot=0,i}return Object(z["a"])(n,[{key:"preload",value:function(){this.load.image("sprite","./sprite.png"),this.load.image("bullet","./bullet.png")}},{key:"create",value:function(){var e=this;this.graphics=this.add.graphics({lineStyle:{width:2,color:11141290}}),this.createGroups(),this.createBlocks(),this.sprite=this.physics.add.sprite(this.spritePosition,_.height-_.blockHeight/2,"sprite");var t=this.add.rectangle(_.width/2,_.height-_.blockHeight/4,_.width,_.blockHeight/2);this.bottomLines.add(t),this.physics.add.collider(this.bullets,this.blocks,(function(t,n){e.removeLifeFromBlock(n)})),this.physics.add.collider(this.bullets,this.bottomLines,(function(t){0===e.bulletsKilled&&(e.spritePosition=t.x),e.bulletsKilled++,e.bulletsKilled>=e.level&&e.newLevel(),t.destroy()})),this.input.on("pointerup",(function(){e.shooting||(e.shooting=!0,e.fireX=e.input.x,e.fireY=e.input.y)})),this.checkGameEnded()}},{key:"update",value:function(){if(this.graphics.clear(),!this.gameOver){if(this.input.y>_.height-.5*_.blockHeight)return null;var e=_.height-_.blockHeight/2-this.input.y,t=this.input.x-this.spritePosition,n=e/t;if(n*n<.05)return null;this.shooting&&this.fire(),this.shooting||this.sprite.x===this.spritePosition||(this.sprite.x=this.spritePosition),0!==this.bulletsShot||this.shooting||(this.line=new k["Geom"].Line(this.spritePosition+28,_.height-_.blockHeight/2,this.input.x,this.input.y),this.graphics.strokeLineShape(this.line))}}},{key:"createGroups",value:function(){this.blocks=this.physics.add.group({collideWorldBounds:!0,immovable:!0}),this.bullets=this.physics.add.group({collideWorldBounds:!0,bounceX:1,bounceY:1}),this.bottomLines=this.physics.add.group({collideWorldBounds:!0,immovable:!0})}},{key:"createBlocks",value:function(){for(var e=0;e<this.raw_blocks.length;e++){var t=this.add.rectangle((this.raw_blocks[e].x+.5)*_.blockWidth,(this.raw_blocks[e].y+.5)*_.blockHeight,_.blockWidth,_.blockHeight,G[this.raw_blocks[e].start%G.length]),n=this.add.text((this.raw_blocks[e].x+.1)*_.blockWidth,(this.raw_blocks[e].y+.1)*_.blockHeight,this.raw_blocks[e].left,ie);t.left=this.raw_blocks[e].left,t.rawOriginBlock=this.raw_blocks[e],t.textBlock=n,this.blocks.add(t)}}},{key:"createBullet",value:function(e,t){var n=t-(_.height-_.blockHeight/2),i=e-(this.spritePosition+28),o=n/i,r=180*Math.atan(o)/3.1415;i<0&&(r=180+r);var c=this.physics.velocityFromAngle(r,_.bulletSpeed),a=c.x,s=c.y,l=this.bullets.create(this.spritePosition+28,_.height-_.blockHeight/2,"bullet");l.setVelocity(a,s)}},{key:"fire",value:function(){this.bulletsShot<this.level?this.time.now>this.nextFire&&(this.nextFire=this.time.now+this.fireRate,this.createBullet(this.fireX,this.fireY),this.bulletsShot++):this.shooting=!1}},{key:"removeLifeFromBlock",value:function(e){e.left--,e.textBlock.text=parseInt(e.textBlock.text)-1,e.rawOriginBlock.left--,e.left<=0&&(e.textBlock.destroy(),e.destroy())}},{key:"newLevel",value:function(){var e=this;this.level++,this.bulletsKilled=0,this.bulletsShot=0;var t=[];this.raw_blocks.forEach((function(n){n&&n.left>0&&(n.y++,t.push(n),n.y>=9&&(e.gameOver=!0)),n&&n.textBlock&&n.textBlock.destroy()})),this.raw_blocks=t;var n=this.generateRow(5,this.level);n.forEach((function(t){t&&e.raw_blocks.push(t)})),this.blocks.clear(!0),this.createBlocks(),this.saveToDb(),this.gameOver&&this.finishGame()}},{key:"checkGameEnded",value:function(){var e=this;this.raw_blocks.forEach((function(t){t&&t.left>0&&(t.y++,t.y>=9&&(e.gameOver=!0))})),this.gameOver&&this.finishGame()}},{key:"saveToDb",value:function(){var e={blocks:this.raw_blocks,level:this.level,position:this.spritePosition};l.a.post(x.game,e)}},{key:"generateRow",value:function(e,t){for(var n=[],i=0;i<e;i++){var o=parseInt(8*Math.random());n[o]?i--:n[o]={x:o,y:1,left:t,start:t}}return n}},{key:"finishGame",value:function(){document.getElementById("actions_menu").classList.add("visible"),document.getElementById("quit_button").innerHTML="Quit"}}]),n}(k["Scene"]);window.mitt=window.mitt||new C["a"];var re={name:"GameScene",data:function(){return{inFullScreen:!1}},mounted:function(){var e=this,t=document.getElementById("parent");l.a.get(x.game).then((function(n){var i={level:n.data.level,spritePosition:n.data.position,blocks:n.data.blocks};n.data?e.gameScene=new j.a.Game(y(new oe(i),t,_.width,_.height,j.a.Scale.FIT)):e.gameScene=new j.a.Game(y(new oe(E()),t,_.width,_.height,j.a.Scale.FIT))})),window.mitt.on("restart",(function(){e.gameScene.destroy(!0),e.gameScene=new j.a.Game(y(new oe(E()),t,_.width,_.height,j.a.Scale.FIT))}))},methods:{fullScreen:function(){var e=document.getElementById("parent"),t=document.getElementById("fullScreenButton");this.inFullScreen?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():e.requestFullscreen?(e.requestFullscreen(),t.requestFullscreen()):e.webkitRequestFullscreen?(e.webkitRequestFullscreen(),t.webkitRequestFullscreen()):e.msRequestFullscreen&&(e.msRequestFullscreen(),t.msRequestFullscreen()),this.inFullScreen=!this.inFullScreen}}};n("27de");re.render=J,re.__scopeId="data-v-270a14a0";var ce=re,ae={name:"Game",components:{GameScene:ce,ActionsMenu:N,UserHamburgerMenu:F},data:function(){return{showHamburgerMenu:!1,game:{highestScore:0}}},methods:{createNewGame:function(){var e=[1,0,1,1,1];return{blocks:e,level:1}}},mounted:function(){var e=this;l.a.get(x.game).then((function(t){e.game=t.data?t.data:e.createNewGame()}))},beforeRouteEnter:function(e,t,n){var i=function(){l.a.get(x.createLocalAccountUrl).then((function(e){h.dispatch("setLogged",!1),h.dispatch("setUsername",e.data.username),n()})).catch((function(){location.href=location.origin+"/error?from="+location.pathname}))};-1===h.state.logged||""===h.state.username?l.a.get(x.getLoginInfoUrl).then((function(e){e.data?(h.dispatch("setLogged",e.data.google_signed_in),h.dispatch("setUsername",e.data.username),n()):i()})).catch((function(){location.href=location.origin+"/error?from="+location.pathname})):null===h.state.username&&!1===h.state.logged?i():n()}};n("3214");ae.render=a,ae.__scopeId="data-v-3da9e021";var se=ae,le={name:"App",components:{Game:se}};n("c55d");le.render=o;var ue=le;Object(i["a"])(ue).use(h).mount("#app")},aa82:function(e,t,n){},c55d:function(e,t,n){"use strict";n("49be")},c749:function(e,t,n){e.exports=n.p+"img/hamburger_icon_dark.65809c1c.png"},cf05:function(e,t,n){e.exports=n.p+"img/logo.452bb9ec.png"},d55f:function(e,t,n){},e135:function(e,t,n){"use strict";n("f523")},e8a9:function(e,t,n){},f523:function(e,t,n){},f773:function(e,t,n){e.exports=n.p+"img/title.551da945.png"}});
//# sourceMappingURL=app.dc94cbcb.js.map