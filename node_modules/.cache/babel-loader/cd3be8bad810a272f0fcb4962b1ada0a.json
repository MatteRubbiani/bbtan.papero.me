{"remainingRequest":"C:\\Users\\matte\\Desktop\\papero\\bbtan.papero.me\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\matte\\Desktop\\papero\\bbtan.papero.me\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\matte\\Desktop\\papero\\bbtan.papero.me\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\matte\\Desktop\\papero\\bbtan.papero.me\\phaser\\GameScene.js","dependencies":[{"path":"C:\\Users\\matte\\Desktop\\papero\\bbtan.papero.me\\phaser\\GameScene.js","mtime":1620196047507},{"path":"C:\\Users\\matte\\Desktop\\papero\\bbtan.papero.me\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\matte\\Desktop\\papero\\bbtan.papero.me\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\matte\\Desktop\\papero\\bbtan.papero.me\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\matte\\Desktop\\papero\\bbtan.papero.me\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOi9Vc2Vycy9tYXR0ZS9EZXNrdG9wL3BhcGVyby9iYnRhbi5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJDOi9Vc2Vycy9tYXR0ZS9EZXNrdG9wL3BhcGVyby9iYnRhbi5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQgZnJvbSAiQzovVXNlcnMvbWF0dGUvRGVza3RvcC9wYXBlcm8vYmJ0YW4ucGFwZXJvLm1lL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkM6L1VzZXJzL21hdHRlL0Rlc2t0b3AvcGFwZXJvL2JidGFuLnBhcGVyby5tZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vaW5oZXJpdHMiOwppbXBvcnQgX2NyZWF0ZVN1cGVyIGZyb20gIkM6L1VzZXJzL21hdHRlL0Rlc2t0b3AvcGFwZXJvL2JidGFuLnBhcGVyby5tZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlU3VwZXIiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIkM6L1VzZXJzL21hdHRlL0Rlc2t0b3AvcGFwZXJvL2JidGFuLnBhcGVyby5tZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICogYXMgUGhhc2VyIGZyb20gInBoYXNlciI7CmltcG9ydCB7IHBoYXNlciwgY29sb3JzLCB1cmxzIH0gZnJvbSAiLi4vc3JjL2NvbnN0YW50cy9jb25zdGFudHMiOwppbXBvcnQgbWl0dCBmcm9tICJtaXR0IjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKd2luZG93Lm1pdHQgPSB3aW5kb3cubWl0dCB8fCBuZXcgbWl0dCgpOwp2YXIgc3R5bGUgPSB7CiAgZm9udDogIjMwcHggQXJpYWwiLAogIGZpbGw6ICIjMDAwMDAwIiwKICB3b3JkV3JhcDogdHJ1ZSwKICB3b3JkV3JhcFdpZHRoOiBwaGFzZXIuYmxvY2tXaWR0aCwKICBhbGlnbjogImxlZnQiCn07Cgp2YXIgR2FtZVNjZW5lID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfUGhhc2VyJFNjZW5lKSB7CiAgX2luaGVyaXRzKEdhbWVTY2VuZSwgX1BoYXNlciRTY2VuZSk7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoR2FtZVNjZW5lKTsKCiAgZnVuY3Rpb24gR2FtZVNjZW5lKGdhbWUpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgR2FtZVNjZW5lKTsKCiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm5leHRGaXJlIiwgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZmlyZVJhdGUiLCAxMDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImZpcmVYIiwgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZmlyZVkiLCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnYW1lT3ZlciIsIGZhbHNlKTsKCiAgICBfdGhpcy5yYXdfYmxvY2tzID0gZ2FtZS5ibG9ja3M7CiAgICBfdGhpcy5sZXZlbCA9IGdhbWUubGV2ZWw7CiAgICBfdGhpcy5zcHJpdGVQb3NpdGlvbiA9IGdhbWUuc3ByaXRlUG9zaXRpb247CiAgICBfdGhpcy5zaG9vdGluZyA9IGZhbHNlOwogICAgX3RoaXMuYnVsbGV0c0tpbGxlZCA9IDA7CiAgICBfdGhpcy5idWxsZXRzU2hvdCA9IDA7CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoR2FtZVNjZW5lLCBbewogICAga2V5OiAicHJlbG9hZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHJlbG9hZCgpIHsKICAgICAgdGhpcy5sb2FkLmltYWdlKCJzcHJpdGUiLCAiLi9zcHJpdGUucG5nIik7CiAgICAgIHRoaXMubG9hZC5pbWFnZSgiYnVsbGV0IiwgIi4vYnVsbGV0LnBuZyIpOwogICAgfQogIH0sIHsKICAgIGtleTogImNyZWF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMuZ3JhcGhpY3MgPSB0aGlzLmFkZC5ncmFwaGljcyh7CiAgICAgICAgbGluZVN0eWxlOiB7CiAgICAgICAgICB3aWR0aDogMiwKICAgICAgICAgIGNvbG9yOiAweGFhMDBhYQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHRoaXMuY2FtZXJhcy5tYWluLnNldEJhY2tncm91bmRDb2xvcignI2ZmZmZmZicpOwogICAgICB0aGlzLmNyZWF0ZUdyb3VwcygpOwogICAgICB0aGlzLmNyZWF0ZUJsb2NrcygpOwogICAgICB0aGlzLnNwcml0ZSA9IHRoaXMucGh5c2ljcy5hZGQuc3ByaXRlKHRoaXMuc3ByaXRlUG9zaXRpb24sIHBoYXNlci5oZWlnaHQgLSBwaGFzZXIuYmxvY2tIZWlnaHQgLyAyLCAic3ByaXRlIik7CiAgICAgIHZhciBib3R0b21MaW5lID0gdGhpcy5hZGQucmVjdGFuZ2xlKHBoYXNlci53aWR0aCAvIDIsIHBoYXNlci5oZWlnaHQgLSBwaGFzZXIuYmxvY2tIZWlnaHQgLyA0LCBwaGFzZXIud2lkdGgsIHBoYXNlci5ibG9ja0hlaWdodCAvIDIpOwogICAgICB0aGlzLmJvdHRvbUxpbmVzLmFkZChib3R0b21MaW5lKTsKICAgICAgdGhpcy5waHlzaWNzLmFkZC5jb2xsaWRlcih0aGlzLmJ1bGxldHMsIHRoaXMuYmxvY2tzLCBmdW5jdGlvbiAoYnVsbGV0LCBibG9jaykgewogICAgICAgIF90aGlzMi5yZW1vdmVMaWZlRnJvbUJsb2NrKGJsb2NrKTsKICAgICAgfSk7CiAgICAgIHRoaXMucGh5c2ljcy5hZGQuY29sbGlkZXIodGhpcy5idWxsZXRzLCB0aGlzLmJvdHRvbUxpbmVzLCBmdW5jdGlvbiAoYnVsbGV0KSB7CiAgICAgICAgaWYgKF90aGlzMi5idWxsZXRzS2lsbGVkID09PSAwKSB7CiAgICAgICAgICAvL3RoaXMuc3ByaXRlLnggPSBidWxsZXQueAogICAgICAgICAgX3RoaXMyLnNwcml0ZVBvc2l0aW9uID0gYnVsbGV0Lng7CiAgICAgICAgfQoKICAgICAgICBfdGhpczIuYnVsbGV0c0tpbGxlZCsrOwoKICAgICAgICBpZiAoX3RoaXMyLmJ1bGxldHNLaWxsZWQgPj0gX3RoaXMyLmxldmVsKSB7CiAgICAgICAgICAvL2NoYW5nZSBsZXZlbAogICAgICAgICAgX3RoaXMyLm5ld0xldmVsKCk7CiAgICAgICAgfQoKICAgICAgICBidWxsZXQuZGVzdHJveSgpOwogICAgICB9KTsKICAgICAgdGhpcy5pbnB1dC5vbigicG9pbnRlcnVwIiwgZnVuY3Rpb24gKCkgewogICAgICAgIGlmICghX3RoaXMyLnNob290aW5nKSB7CiAgICAgICAgICBfdGhpczIuc2hvb3RpbmcgPSB0cnVlOwoKICAgICAgICAgIGlmIChfdGhpczIuaW5wdXQueSA8IHBoYXNlci5oZWlnaHQgLSAuNSAqIHBoYXNlci5ibG9ja0hlaWdodCkgewogICAgICAgICAgICB2YXIgZFkgPSBwaGFzZXIuaGVpZ2h0IC0gcGhhc2VyLmJsb2NrSGVpZ2h0IC8gMiAtIF90aGlzMi5pbnB1dC55OwogICAgICAgICAgICB2YXIgZFggPSBfdGhpczIuaW5wdXQueCAtIF90aGlzMi5zcHJpdGVQb3NpdGlvbjsKICAgICAgICAgICAgdmFyIG0gPSBkWSAvIGRYOwoKICAgICAgICAgICAgaWYgKG0gKiBtID4gLjA1KSB7CiAgICAgICAgICAgICAgX3RoaXMyLmZpcmVYID0gX3RoaXMyLmlucHV0Lng7CiAgICAgICAgICAgICAgX3RoaXMyLmZpcmVZID0gX3RoaXMyLmlucHV0Lnk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLmNoZWNrR2FtZUVuZGVkKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGUoKSB7CiAgICAgIHRoaXMuZ3JhcGhpY3MuY2xlYXIoKTsKCiAgICAgIGlmICghdGhpcy5nYW1lT3ZlcikgewogICAgICAgIC8vZmlyZQogICAgICAgIGlmICh0aGlzLmlucHV0LnkgPiBwaGFzZXIuaGVpZ2h0IC0gLjUgKiBwaGFzZXIuYmxvY2tIZWlnaHQpIHJldHVybiBudWxsOwogICAgICAgIHZhciBkWSA9IHBoYXNlci5oZWlnaHQgLSBwaGFzZXIuYmxvY2tIZWlnaHQgLyAyIC0gdGhpcy5pbnB1dC55OwogICAgICAgIHZhciBkWCA9IHRoaXMuaW5wdXQueCAtIHRoaXMuc3ByaXRlUG9zaXRpb247CiAgICAgICAgdmFyIG0gPSBkWSAvIGRYOwogICAgICAgIGlmIChtICogbSA8IC4wNSkgcmV0dXJuIG51bGw7CgogICAgICAgIGlmICh0aGlzLnNob290aW5nKSB7CiAgICAgICAgICB0aGlzLmZpcmUoKTsKICAgICAgICB9CgogICAgICAgIGlmICghdGhpcy5zaG9vdGluZyAmJiB0aGlzLnNwcml0ZS54ICE9PSB0aGlzLnNwcml0ZVBvc2l0aW9uKSB7CiAgICAgICAgICB0aGlzLnNwcml0ZS54ID0gdGhpcy5zcHJpdGVQb3NpdGlvbjsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLmJ1bGxldHNTaG90ID09PSAwICYmICF0aGlzLnNob290aW5nKSB7CiAgICAgICAgICB0aGlzLmxpbmUgPSBuZXcgUGhhc2VyLkdlb20uTGluZSh0aGlzLnNwcml0ZVBvc2l0aW9uICsgMjgsIC8vIGhvIGFnZ2l1bnRvIG1ldGEgZGVsbGEgbGFyZ2hlenphIGRlbGxvIHNwcml0ZQogICAgICAgICAgcGhhc2VyLmhlaWdodCAtIHBoYXNlci5ibG9ja0hlaWdodCAvIDIsIHRoaXMuaW5wdXQueCwgdGhpcy5pbnB1dC55KTsKICAgICAgICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlTGluZVNoYXBlKHRoaXMubGluZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9IC8vY3JlYXRvcnMKCiAgfSwgewogICAga2V5OiAiY3JlYXRlR3JvdXBzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVHcm91cHMoKSB7CiAgICAgIHRoaXMuYmxvY2tzID0gdGhpcy5waHlzaWNzLmFkZC5ncm91cCh7CiAgICAgICAgY29sbGlkZVdvcmxkQm91bmRzOiB0cnVlLAogICAgICAgIGltbW92YWJsZTogdHJ1ZQogICAgICB9KTsKICAgICAgdGhpcy5idWxsZXRzID0gdGhpcy5waHlzaWNzLmFkZC5ncm91cCh7CiAgICAgICAgY29sbGlkZVdvcmxkQm91bmRzOiB0cnVlLAogICAgICAgIGJvdW5jZVg6IDEsCiAgICAgICAgYm91bmNlWTogMQogICAgICB9KTsKICAgICAgdGhpcy5ib3R0b21MaW5lcyA9IHRoaXMucGh5c2ljcy5hZGQuZ3JvdXAoewogICAgICAgIGNvbGxpZGVXb3JsZEJvdW5kczogdHJ1ZSwKICAgICAgICBpbW1vdmFibGU6IHRydWUKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY3JlYXRlQmxvY2tzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVCbG9ja3MoKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5yYXdfYmxvY2tzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGEgPSB0aGlzLmFkZC5yZWN0YW5nbGUoKHRoaXMucmF3X2Jsb2Nrc1tpXS54ICsgLjUpICogcGhhc2VyLmJsb2NrV2lkdGgsICh0aGlzLnJhd19ibG9ja3NbaV0ueSArIC41KSAqIHBoYXNlci5ibG9ja0hlaWdodCwgcGhhc2VyLmJsb2NrV2lkdGgsIHBoYXNlci5ibG9ja0hlaWdodCwgY29sb3JzW3RoaXMucmF3X2Jsb2Nrc1tpXS5zdGFydCAlIGNvbG9ycy5sZW5ndGhdKTsKICAgICAgICB2YXIgdEIgPSB0aGlzLmFkZC50ZXh0KCh0aGlzLnJhd19ibG9ja3NbaV0ueCArIC4xMCkgKiBwaGFzZXIuYmxvY2tXaWR0aCwgKHRoaXMucmF3X2Jsb2Nrc1tpXS55ICsgLjEwKSAqIHBoYXNlci5ibG9ja0hlaWdodCwgdGhpcy5yYXdfYmxvY2tzW2ldLmxlZnQsIHN0eWxlKTsKICAgICAgICBhLmxlZnQgPSB0aGlzLnJhd19ibG9ja3NbaV0ubGVmdDsKICAgICAgICBhLnJhd09yaWdpbkJsb2NrID0gdGhpcy5yYXdfYmxvY2tzW2ldOwogICAgICAgIGEudGV4dEJsb2NrID0gdEI7CiAgICAgICAgdGhpcy5ibG9ja3MuYWRkKGEpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiY3JlYXRlQnVsbGV0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVCdWxsZXQoWCwgWSkgewogICAgICB2YXIgZFkgPSBZIC0gKHBoYXNlci5oZWlnaHQgLSBwaGFzZXIuYmxvY2tIZWlnaHQgLyAyKTsKICAgICAgdmFyIGRYID0gWCAtICh0aGlzLnNwcml0ZS54ICsgMjgpOyAvLyBobyBhZ2dpdW50byBtZXRhIHNwcml0ZSBsYXJnaGV6emEKCiAgICAgIHZhciBtID0gZFkgLyBkWDsKICAgICAgdmFyIGFuZ2xlID0gTWF0aC5hdGFuKG0pICogMTgwIC8gMy4xNDE1OwoKICAgICAgaWYgKGRYIDwgMCkgewogICAgICAgIGFuZ2xlID0gMTgwICsgYW5nbGU7CiAgICAgIH0KCiAgICAgIHZhciBfdGhpcyRwaHlzaWNzJHZlbG9jaXQgPSB0aGlzLnBoeXNpY3MudmVsb2NpdHlGcm9tQW5nbGUoYW5nbGUsIHBoYXNlci5idWxsZXRTcGVlZCksCiAgICAgICAgICB4ID0gX3RoaXMkcGh5c2ljcyR2ZWxvY2l0LngsCiAgICAgICAgICB5ID0gX3RoaXMkcGh5c2ljcyR2ZWxvY2l0Lnk7CgogICAgICB2YXIgYnVsbGV0ID0gdGhpcy5idWxsZXRzLmNyZWF0ZSh0aGlzLnNwcml0ZS54ICsgMjgsIC8vIGFnZ2l1bnRvIG1ldGEgc3ByaXRlIGxhcmdoZXp6YQogICAgICBwaGFzZXIuaGVpZ2h0IC0gcGhhc2VyLmJsb2NrSGVpZ2h0IC8gMiwgImJ1bGxldCIpOwogICAgICBidWxsZXQuc2V0VmVsb2NpdHkoeCwgeSk7CiAgICB9IC8vdXBkYXRvcnMKCiAgfSwgewogICAga2V5OiAiZmlyZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmlyZSgpIHsKICAgICAgaWYgKHRoaXMuYnVsbGV0c1Nob3QgPCB0aGlzLmxldmVsKSB7CiAgICAgICAgaWYgKHRoaXMudGltZS5ub3cgPiB0aGlzLm5leHRGaXJlKSB7CiAgICAgICAgICB0aGlzLm5leHRGaXJlID0gdGhpcy50aW1lLm5vdyArIHRoaXMuZmlyZVJhdGU7CiAgICAgICAgICB0aGlzLmNyZWF0ZUJ1bGxldCh0aGlzLmZpcmVYLCB0aGlzLmZpcmVZKTsKICAgICAgICAgIHRoaXMuYnVsbGV0c1Nob3QrKzsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zaG9vdGluZyA9IGZhbHNlOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAicmVtb3ZlTGlmZUZyb21CbG9jayIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlTGlmZUZyb21CbG9jayhibG9jaykgewogICAgICBibG9jay5sZWZ0LS07CiAgICAgIGJsb2NrLnRleHRCbG9jay50ZXh0ID0gcGFyc2VJbnQoYmxvY2sudGV4dEJsb2NrLnRleHQpIC0gMTsKICAgICAgYmxvY2sucmF3T3JpZ2luQmxvY2subGVmdC0tOwoKICAgICAgaWYgKGJsb2NrLmxlZnQgPD0gMCkgewogICAgICAgIGJsb2NrLnRleHRCbG9jay5kZXN0cm95KCk7CiAgICAgICAgYmxvY2suZGVzdHJveSgpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAibmV3TGV2ZWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG5ld0xldmVsKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHRoaXMubGV2ZWwrKzsKICAgICAgdGhpcy5idWxsZXRzS2lsbGVkID0gMDsKICAgICAgdGhpcy5idWxsZXRzU2hvdCA9IDA7CiAgICAgIHZhciBjbGVhbkJsb2NrcyA9IFtdOwogICAgICB0aGlzLnJhd19ibG9ja3MuZm9yRWFjaChmdW5jdGlvbiAoYikgewogICAgICAgIGlmIChiICYmIGIubGVmdCA+IDApIHsKICAgICAgICAgIGIueSsrOwogICAgICAgICAgY2xlYW5CbG9ja3MucHVzaChiKTsgLy9jaGVjayBnYW1lIG92ZXIKCiAgICAgICAgICBpZiAoYi55ID49IDkpIF90aGlzMy5nYW1lT3ZlciA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBpZiAoYiAmJiBiLnRleHRCbG9jaykgYi50ZXh0QmxvY2suZGVzdHJveSgpOwogICAgICB9KTsKICAgICAgdGhpcy5yYXdfYmxvY2tzID0gY2xlYW5CbG9ja3M7CiAgICAgIHZhciBuZXdCbG9ja3MgPSB0aGlzLmdlbmVyYXRlUm93KDUsIHRoaXMubGV2ZWwpOwogICAgICBuZXdCbG9ja3MuZm9yRWFjaChmdW5jdGlvbiAoYmxvY2spIHsKICAgICAgICBpZiAoYmxvY2spIF90aGlzMy5yYXdfYmxvY2tzLnB1c2goYmxvY2spOwogICAgICB9KTsKICAgICAgdGhpcy5ibG9ja3MuY2xlYXIodHJ1ZSk7CiAgICAgIHRoaXMuY3JlYXRlQmxvY2tzKCk7IC8vZmFpIHR1dHRvIGlsIHJlc3RvCgogICAgICB0aGlzLnNhdmVUb0RiKCk7CiAgICAgIGlmICh0aGlzLmdhbWVPdmVyKSB0aGlzLmZpbmlzaEdhbWUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjaGVja0dhbWVFbmRlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2hlY2tHYW1lRW5kZWQoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdGhpcy5yYXdfYmxvY2tzLmZvckVhY2goZnVuY3Rpb24gKGIpIHsKICAgICAgICBpZiAoYiAmJiBiLmxlZnQgPiAwKSB7CiAgICAgICAgICBpZiAoYi55ID49IDkpIF90aGlzNC5nYW1lT3ZlciA9IHRydWU7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgaWYgKHRoaXMuZ2FtZU92ZXIpIHRoaXMuZmluaXNoR2FtZSgpOwogICAgfQogIH0sIHsKICAgIGtleTogInNhdmVUb0RiIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzYXZlVG9EYigpIHsKICAgICAgdmFyIGRhdGEgPSB7CiAgICAgICAgYmxvY2tzOiB0aGlzLnJhd19ibG9ja3MsCiAgICAgICAgbGV2ZWw6IHRoaXMubGV2ZWwsCiAgICAgICAgcG9zaXRpb246IHRoaXMuc3ByaXRlUG9zaXRpb24KICAgICAgfTsKICAgICAgYXhpb3MucG9zdCh1cmxzLmdhbWUsIGRhdGEpOwogICAgfQogIH0sIHsKICAgIGtleTogImdlbmVyYXRlUm93IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZW5lcmF0ZVJvdyhudW1iZXJPZkJsb2NrcywgbGVmdCkgewogICAgICB2YXIgYmxvY2tzID0gW107CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bWJlck9mQmxvY2tzOyBpKyspIHsKICAgICAgICB2YXIgbiA9IHBhcnNlSW50KE1hdGgucmFuZG9tKCkgKiA4KTsKCiAgICAgICAgaWYgKCFibG9ja3Nbbl0pIHsKICAgICAgICAgIGJsb2Nrc1tuXSA9IHsKICAgICAgICAgICAgeDogbiwKICAgICAgICAgICAgeTogMSwKICAgICAgICAgICAgbGVmdDogbGVmdCwKICAgICAgICAgICAgc3RhcnQ6IGxlZnQKICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGktLTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBibG9ja3M7CiAgICB9CiAgfSwgewogICAga2V5OiAiZmluaXNoR2FtZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmluaXNoR2FtZSgpIHsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFjdGlvbnNfbWVudSIpLmNsYXNzTGlzdC5hZGQoInZpc2libGUiKTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFycm93LWNvbnRhaW5lciIpLmNsYXNzTGlzdC5hZGQoInZpc2libGUiKTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInF1aXRfYnV0dG9uIikuaW5uZXJIVE1MID0gIlF1aXQiOyAvL3RoaXMuYmxvY2tzLmNsZWFyKHRydWUpCiAgICB9CiAgfV0pOwoKICByZXR1cm4gR2FtZVNjZW5lOwp9KFBoYXNlci5TY2VuZSk7CgpleHBvcnQgeyBHYW1lU2NlbmUgYXMgZGVmYXVsdCB9Ow=="},{"version":3,"sources":["C:/Users/matte/Desktop/papero/bbtan.papero.me/phaser/GameScene.js"],"names":["Phaser","phaser","colors","urls","mitt","axios","window","style","font","fill","wordWrap","wordWrapWidth","blockWidth","align","GameScene","game","raw_blocks","blocks","level","spritePosition","shooting","bulletsKilled","bulletsShot","load","image","graphics","add","lineStyle","width","color","cameras","main","setBackgroundColor","createGroups","createBlocks","sprite","physics","height","blockHeight","bottomLine","rectangle","bottomLines","collider","bullets","bullet","block","removeLifeFromBlock","x","newLevel","destroy","input","on","y","dY","dX","m","fireX","fireY","checkGameEnded","clear","gameOver","fire","line","Geom","Line","strokeLineShape","group","collideWorldBounds","immovable","bounceX","bounceY","i","length","a","start","tB","text","left","rawOriginBlock","textBlock","X","Y","angle","Math","atan","velocityFromAngle","bulletSpeed","create","setVelocity","time","now","nextFire","fireRate","createBullet","parseInt","cleanBlocks","forEach","b","push","newBlocks","generateRow","saveToDb","finishGame","data","position","post","numberOfBlocks","n","random","document","getElementById","classList","innerHTML","Scene"],"mappings":"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","sourcesContent":["import * as Phaser from \"phaser\";\r\nimport {phaser, colors, urls} from \"../src/constants/constants\";\r\nimport mitt from \"mitt\"\r\nimport axios from \"axios\"\r\n\r\nwindow.mitt = window.mitt || new mitt()\r\n\r\nlet style = { font: \"30px Arial\", fill: \"#000000\", wordWrap: true, wordWrapWidth: phaser.blockWidth, align: \"left\" };\r\n\r\nexport default class GameScene extends Phaser.Scene {\r\n    nextFire = 0\r\n    fireRate = 100\r\n    fireX = 0\r\n    fireY = 0\r\n    gameOver = false\r\n    constructor(game) {\r\n        super();\r\n        this.raw_blocks = game.blocks\r\n        this.level = game.level\r\n        this.spritePosition = game.spritePosition\r\n        this.shooting = false\r\n        this.bulletsKilled = 0\r\n        this.bulletsShot = 0\r\n\r\n    }\r\n\r\n    preload(){\r\n        this.load.image(\"sprite\", \"./sprite.png\");\r\n        this.load.image(\"bullet\", \"./bullet.png\");\r\n    }\r\n\r\n    create(){\r\n        this.graphics = this.add.graphics({ lineStyle: { width: 2, color: 0xaa00aa }})\r\n        this.cameras.main.setBackgroundColor('#ffffff')\r\n        this.createGroups()\r\n        this.createBlocks()\r\n        this.sprite = this.physics.add.sprite(this.spritePosition, phaser.height - (phaser.blockHeight / 2), \"sprite\")\r\n        let bottomLine = this.add.rectangle(phaser.width / 2, phaser.height - (phaser.blockHeight / 4), phaser.width, phaser.blockHeight / 2, )\r\n        this.bottomLines.add(bottomLine)\r\n        this.physics.add.collider(this.bullets, this.blocks, (bullet, block) =>{\r\n            this.removeLifeFromBlock(block)\r\n        })\r\n        this.physics.add.collider(this.bullets, this.bottomLines, (bullet) =>{\r\n            if (this.bulletsKilled === 0){\r\n                //this.sprite.x = bullet.x\r\n                this.spritePosition = bullet.x\r\n            }\r\n            this.bulletsKilled ++\r\n            if (this.bulletsKilled >= this.level){\r\n                //change level\r\n                this.newLevel()\r\n            }\r\n            bullet.destroy()\r\n        })\r\n        this.input.on(\"pointerup\", () => {\r\n            if (!this.shooting) {\r\n                this.shooting = true\r\n                if (this.input.y < phaser.height - .5 * phaser.blockHeight){\r\n                    let dY = (phaser.height - (phaser.blockHeight / 2)) - this.input.y\r\n                    let dX = this.input.x - this.spritePosition\r\n                    let m =  dY / dX\r\n                    if (m * m > .05) {\r\n                        this.fireX = this.input.x\r\n                        this.fireY = this.input.y\r\n                    }\r\n                }\r\n            }\r\n        })\r\n        this.checkGameEnded()\r\n    }\r\n\r\n    update() {\r\n        this.graphics.clear();\r\n        if (!this.gameOver) {\r\n            //fire\r\n            if (this.input.y > phaser.height - .5 * phaser.blockHeight) return null\r\n            let dY = (phaser.height - (phaser.blockHeight / 2)) - this.input.y\r\n            let dX = this.input.x - this.spritePosition\r\n            let m =  dY / dX\r\n            if (m * m < .05) return null\r\n            if (this.shooting) {\r\n                this.fire()\r\n            }\r\n            if (!this.shooting && this.sprite.x !== this.spritePosition){\r\n                this.sprite.x = this.spritePosition\r\n            }\r\n            if (this.bulletsShot === 0 && !this.shooting) {\r\n                this.line = new Phaser.Geom.Line(\r\n                    this.spritePosition + 28, // ho aggiunto meta della larghezza dello sprite\r\n                     phaser.height - (phaser.blockHeight / 2),\r\n                    this.input.x,\r\n                    this.input.y)\r\n                this.graphics.strokeLineShape(this.line);\r\n            }\r\n        }\r\n    }\r\n\r\n    //creators\r\n    createGroups(){\r\n        this.blocks = this.physics.add.group({\r\n            collideWorldBounds: true,\r\n            immovable: true\r\n        })\r\n        this.bullets = this.physics.add.group({\r\n            collideWorldBounds: true,\r\n            bounceX: 1,\r\n            bounceY: 1\r\n        })\r\n        this.bottomLines = this.physics.add.group({\r\n            collideWorldBounds: true,\r\n            immovable: true\r\n        })\r\n    }\r\n\r\n    createBlocks(){\r\n        for (let i=0; i<this.raw_blocks.length; i++){\r\n            let a = this.add.rectangle(\r\n                (this.raw_blocks[i].x + .5) * phaser.blockWidth,\r\n                (this.raw_blocks[i].y + .5) * phaser.blockHeight,\r\n                phaser.blockWidth,\r\n                phaser.blockHeight,\r\n                colors[this.raw_blocks[i].start % colors.length])\r\n            let tB = this.add.text(\r\n                (this.raw_blocks[i].x + .10) * phaser.blockWidth,\r\n                (this.raw_blocks[i].y + .10) * phaser.blockHeight,\r\n                this.raw_blocks[i].left, style)\r\n\r\n            a.left = this.raw_blocks[i].left\r\n            a.rawOriginBlock = this.raw_blocks[i]\r\n            a.textBlock = tB\r\n            this.blocks.add(a)\r\n        }\r\n    }\r\n\r\n    createBullet(X, Y){\r\n        let dY = Y - (phaser.height - (phaser.blockHeight / 2))\r\n        let dX = X - (this.sprite.x + 28) // ho aggiunto meta sprite larghezza\r\n        let m =   dY / dX\r\n        let angle = Math.atan(m) * 180 / 3.1415\r\n        if (dX < 0){\r\n            angle =  180 + angle\r\n        }\r\n        let {x, y} = this.physics.velocityFromAngle(angle, phaser.bulletSpeed);\r\n        const bullet = this.bullets.create(\r\n        this.sprite.x + 28, // aggiunto meta sprite larghezza\r\n        phaser.height - (phaser.blockHeight / 2),\r\n        \"bullet\");\r\n        bullet.setVelocity(x, y)\r\n\r\n    }\r\n\r\n    //updators\r\n    fire() {\r\n        if (this.bulletsShot < this.level){\r\n            if (this.time.now > this.nextFire) {\r\n                this.nextFire = this.time.now + this.fireRate;\r\n                this.createBullet(this.fireX, this.fireY);\r\n                this.bulletsShot ++;\r\n            }\r\n        } else {\r\n            this.shooting = false\r\n        }\r\n\r\n    }\r\n\r\n    removeLifeFromBlock(block){\r\n        block.left --;\r\n        block.textBlock.text = parseInt(block.textBlock.text) - 1\r\n        block.rawOriginBlock.left --\r\n        if (block.left <= 0) {\r\n            block.textBlock.destroy()\r\n            block.destroy()\r\n        }\r\n    }\r\n\r\n    newLevel(){\r\n        this.level ++;\r\n        this.bulletsKilled = 0\r\n        this.bulletsShot = 0\r\n        let cleanBlocks = []\r\n        this.raw_blocks.forEach(b => {\r\n            if (b && b.left > 0){\r\n                b.y ++\r\n                cleanBlocks.push(b)\r\n                //check game over\r\n                if (b.y >= 9) this.gameOver = true\r\n            }\r\n            if (b && b.textBlock) b.textBlock.destroy()\r\n        })\r\n        this.raw_blocks = cleanBlocks\r\n        let newBlocks = this.generateRow(5, this.level)\r\n        newBlocks.forEach(block => {\r\n            if (block) this.raw_blocks.push(block)\r\n        })\r\n        this.blocks.clear(true)\r\n        this.createBlocks()\r\n        //fai tutto il resto\r\n        this.saveToDb()\r\n        if (this.gameOver) this.finishGame()\r\n    }\r\n\r\n    checkGameEnded(){\r\n        this.raw_blocks.forEach(b => {\r\n            if (b && b.left > 0){\r\n                if (b.y >= 9) this.gameOver = true\r\n            }\r\n        })\r\n        if (this.gameOver) this.finishGame()\r\n    }\r\n\r\n    saveToDb(){\r\n        const data = {\r\n            blocks: this.raw_blocks,\r\n            level: this.level,\r\n            position: this.spritePosition\r\n        }\r\n        axios.post(urls.game, data)\r\n    }\r\n\r\n    generateRow(numberOfBlocks, left){\r\n        let blocks = []\r\n        for (let i=0; i < numberOfBlocks; i++){\r\n            let n = parseInt(Math.random() * 8)\r\n            if (!blocks[n]) {\r\n                blocks[n] = {\r\n                    x: n,\r\n                    y: 1,\r\n                    left: left,\r\n                    start: left\r\n                }\r\n            }else{\r\n                i--\r\n            }\r\n        }\r\n        return blocks\r\n    }\r\n\r\n    finishGame(){\r\n        document.getElementById(\"actions_menu\").classList.add(\"visible\")\r\n        document.getElementById(\"arrow-container\").classList.add(\"visible\")\r\n        document.getElementById(\"quit_button\").innerHTML = \"Quit\"\r\n        //this.blocks.clear(true)\r\n    }\r\n\r\n}"]}]}